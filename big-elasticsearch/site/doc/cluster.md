### 集群

`Elasticsearch` 是分布式的搜索引擎，集群规模可以支持上百个节点。

#### 节点

节点是组成 `Elasticsearch` 集群的基本服务单元，每个节点都是一个 `Elasticsearch` 进程，同一个集群中的节点就有相同的集群名称(`cluster.name`， 默认为 `elasticsearch`)。

`Elasticsearch` 集群为主从模型，每个节点可以有多个角色，同一个节点在不同的时刻可能会有不同的角色。

- **主节点(Master Node)**

  主节点负责管理集群元数据信息，当主节点故障时会从有资格被选举为 Master 的节点中选举出新的 Master，配置 `node.master:true` 使得节点具备被选举为 Master 的资格。

  为了减少主节点的负载，应该尽量使主节点的角色单一；

- **数据节点(Data Node)**
  数据节点负责保存数据、执行数据相关操作，数据节点对 CPU、内存、I/O 要求较高。配置 `node.data:true` 使得节点具备数据节点角色

- **预处理节点(Ingest Node)**

  预处理允许在索引文档之前通过事先定义好的处理器(`processor`)对数据进行处理，默认情况下所有的节点都是预处理节点，通过配置 `node.ingest:false` 可以禁用预处理。

- **协调节点(Coordinating Node)**

  客户端可以将请求发送到任意节点，接收到客户端请求的节点即为协调节点。协调节点将请求转发到文档所处的节点，并在处理结果返回后进行合并返回给客户端。

#### 集群状态

集群状态由 Master 节点负责维护，主节点接收到数据节点的状态更新则会将更新广播的集群的其他节点，这样集群中的每个节点都拥有整个集群的状态信息。

